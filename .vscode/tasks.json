{
  "version": "2.0.0",
  "tasks": [
    {
      "label": "configure",
      "type": "shell",
      "command": "cmake",
      "args": [
        "-B",
        "build",
        "-DCMAKE_BUILD_TYPE=Release",
        "-DCMAKE_EXPORT_COMPILE_COMMANDS=ON"
      ],
      "group": "build",
      "problemMatcher": [],
      "presentation": {
        "reveal": "silent",
        "panel": "shared"
      }
    },
    {
      "label": "build",
      "type": "shell",
      "command": "cmake",
      "args": [
        "--build",
        "build",
        "--target",
        "visualizer_pcap",
        "-j"
      ],
      "group": {
        "kind": "build",
        "isDefault": true
      },
      "problemMatcher": [
        "$gcc"
      ],
      "presentation": {
        "reveal": "silent",
        "panel": "shared"
      }
    },
    {
      "label": "build all",
      "type": "shell",
      "command": "cmake",
      "args": [
        "--build",
        "build",
        "-j"
      ],
      "group": "build",
      "problemMatcher": [
        "$gcc"
      ],
      "presentation": {
        "reveal": "always",
        "panel": "shared"
      }
    },
    {
      "label": "build market_maker_sim",
      "type": "shell",
      "command": "cmake",
      "args": [
        "--build",
        "build",
        "--target",
        "market_maker_sim",
        "-j"
      ],
      "group": "build",
      "problemMatcher": [
        "$gcc"
      ],
      "presentation": {
        "reveal": "silent",
        "panel": "shared"
      }
    },
    {
      "label": "clean",
      "type": "shell",
      "command": "cmake",
      "args": [
        "--build",
        "build",
        "--target",
        "clean"
      ],
      "group": "build",
      "problemMatcher": [],
      "presentation": {
        "reveal": "always",
        "panel": "shared"
      }
    },
    {
      "label": "rebuild",
      "type": "shell",
      "command": "cmake",
      "args": [
        "--build",
        "build",
        "--clean-first",
        "-j"
      ],
      "group": "build",
      "problemMatcher": [
        "$gcc"
      ],
      "presentation": {
        "reveal": "always",
        "panel": "shared"
      }
    },
    {
      "label": "run visualizer (AAPL)",
      "type": "shell",
      "command": "${workspaceFolder}/build/visualizer_pcap",
      "args": [
        "${input:pcapFile}",
        "-t",
        "AAPL",
        "-s",
        "${input:symbolFile}"
      ],
      "group": "test",
      "dependsOn": "build",
      "problemMatcher": [],
      "presentation": {
        "reveal": "always",
        "panel": "dedicated"
      }
    },
    {
      "label": "run visualizer (all symbols)",
      "type": "shell",
      "command": "${workspaceFolder}/build/visualizer_pcap",
      "args": [
        "${input:pcapFile}",
        "-s",
        "${input:symbolFile}"
      ],
      "group": "test",
      "dependsOn": "build",
      "problemMatcher": [],
      "presentation": {
        "reveal": "always",
        "panel": "dedicated"
      }
    },
    {
      "label": "run visualizer (custom ticker)",
      "type": "shell",
      "command": "${workspaceFolder}/build/visualizer_pcap",
      "args": [
        "${input:pcapFile}",
        "-t",
        "${input:ticker}",
        "-s",
        "${input:symbolFile}"
      ],
      "group": "test",
      "dependsOn": "build",
      "problemMatcher": [],
      "presentation": {
        "reveal": "always",
        "panel": "dedicated"
      }
    },
    {
      "label": "run market maker (AAPL)",
      "type": "shell",
      "command": "${workspaceFolder}/build/market_maker_sim",
      "args": [
        "${input:pcapFile}",
        "${input:symbolFile}",
        "-t",
        "AAPL",
        "--threads",
        "${input:threads}"
      ],
      "group": "test",
      "dependsOn": "build market_maker_sim",
      "problemMatcher": [],
      "presentation": {
        "reveal": "always",
        "panel": "dedicated"
      }
    },
    {
      "label": "run market maker (all symbols)",
      "type": "shell",
      "command": "${workspaceFolder}/build/market_maker_sim",
      "args": [
        "${input:pcapFile}",
        "${input:symbolFile}",
        "--threads",
        "${input:threads}"
      ],
      "group": "test",
      "dependsOn": "build market_maker_sim",
      "problemMatcher": [],
      "presentation": {
        "reveal": "always",
        "panel": "dedicated"
      }
    },
    {
      "label": "run market maker (custom ticker)",
      "type": "shell",
      "command": "${workspaceFolder}/build/market_maker_sim",
      "args": [
        "${input:pcapFile}",
        "${input:symbolFile}",
        "-t",
        "${input:ticker}",
        "--threads",
        "${input:threads}"
      ],
      "group": "test",
      "dependsOn": "build market_maker_sim",
      "problemMatcher": [],
      "presentation": {
        "reveal": "always",
        "panel": "dedicated"
      }
    },
    {
      "label": "run market maker (hybrid - full day)",
      "type": "shell",
      "command": "${workspaceFolder}/build/market_maker_sim",
      "args": [
        "${input:pcapDir}/*.pcap",
        "${input:symbolFile}",
        "--threads",
        "${input:threads}"
      ],
      "options": {
        "shell": {
          "executable": "/bin/bash",
          "args": ["-c"]
        }
      },
      "group": "test",
      "dependsOn": "build market_maker_sim",
      "problemMatcher": [],
      "presentation": {
        "reveal": "always",
        "panel": "dedicated"
      }
    },
    {
      "label": "run market maker (hybrid - full day - ticker)",
      "type": "shell",
      "command": "${workspaceFolder}/build/market_maker_sim",
      "args": [
        "${input:pcapDir}/*.pcap",
        "${input:symbolFile}",
        "-t",
        "${input:ticker}",
        "--threads",
        "${input:threads}"
      ],
      "options": {
        "shell": {
          "executable": "/bin/bash",
          "args": ["-c"]
        }
      },
      "group": "test",
      "dependsOn": "build market_maker_sim",
      "problemMatcher": [],
      "presentation": {
        "reveal": "always",
        "panel": "dedicated"
      }
    },
    {
      "label": "run market maker (shell script - full day)",
      "type": "shell",
      "command": "${workspaceFolder}/scripts/run_full_day.sh",
      "group": "test",
      "dependsOn": "build market_maker_sim",
      "problemMatcher": [],
      "presentation": {
        "reveal": "always",
        "panel": "dedicated"
      }
    },
    {
      "label": "run market maker (shell script - trading hours)",
      "type": "shell",
      "command": "${workspaceFolder}/scripts/run_full_day.sh",
      "args": [
        "--trading-hours-only"
      ],
      "group": "test",
      "dependsOn": "build market_maker_sim",
      "problemMatcher": [],
      "presentation": {
        "reveal": "always",
        "panel": "dedicated"
      }
    },
    {
      "label": "run market maker (shell script - AAPL)",
      "type": "shell",
      "command": "${workspaceFolder}/scripts/run_full_day.sh",
      "args": [
        "-t",
        "AAPL",
        "--trading-hours-only"
      ],
      "group": "test",
      "dependsOn": "build market_maker_sim",
      "problemMatcher": [],
      "presentation": {
        "reveal": "always",
        "panel": "dedicated"
      }
    }
  ],
  "inputs": [
    {
      "id": "ticker",
      "type": "promptString",
      "description": "Enter ticker symbol (e.g., AAPL, MSFT, TSLA)"
    },
    {
      "id": "pcapFile",
      "type": "pickString",
      "description": "Select PCAP data file",
      "options": [
        "data/ny4-xnys-pillar-a-20230822T133000.pcap"
      ],
      "default": "data/ny4-xnys-pillar-a-20230822T133000.pcap"
    },
    {
      "id": "pcapDir",
      "type": "pickString",
      "description": "Select PCAP directory for hybrid/full-day processing",
      "options": [
        "data/uncompressed-ny4-xnyx-pillar-a-20230822"
      ],
      "default": "data/uncompressed-ny4-xnyx-pillar-a-20230822"
    },
    {
      "id": "symbolFile",
      "type": "pickString",
      "description": "Select symbol mapping file",
      "options": [
        "data/symbol_nyse_parsed.csv"
      ],
      "default": "data/symbol_nyse_parsed.csv"
    },
    {
      "id": "threads",
      "type": "pickString",
      "description": "Number of parallel threads/processes (0 = auto-detect)",
      "options": [
        "0",
        "4",
        "8",
        "12",
        "14",
        "16"
      ],
      "default": "0"
    }
  ]
}
